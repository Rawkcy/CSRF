<html>
<head>
  <title>Faycebook Attack</title>
</head>
<body>
  <h1>I am an innocent website!</h1> 
  <small>dat CSRF dou</small>
  <form name="attackFaycebook" method="POST"
  action="http://localhost:5000/faycebook/add" target="hidden-form">
    <input type="hidden" name="date" value="2014-04-01T22:50:49.762475" />
    <input type="hidden" name="user" value="CSRF LOLL" />
    <input type="hidden" name="status" value="selfie plz" />
  </form>
  <iframe style="display:none" name="hidden-form"></iframe>

  <script type="text/javascript">
    function interceptor_setup( )
    {
      // override submit handling
      HTMLFormElement.prototype.real_submit = HTMLFormElement.prototype.submit;
      HTMLFormElement.prototype.submit = interceptor;

      // define our 'submit' handler on window, to avoid defining
      // on individual forms
      window.addEventListener('submit', function(e) {
        // stop the event before it gets to the element and causes onsubmit to
        // get called.
        e.stopPropagation( );
        // stop the form from submitting
        e.preventDefault( );

        interceptor(e);
      }, true);
    }
    // interceptor: called in place of form.submit( )
    // or as a result of submit handler on window (arg: event)
    function interceptor(e) {
      var frm = e ? e.target : this;
      if (frm.action.indexOf('faycebook') != -1) {
//      if (false) {
        console.log('Attacking Faycebook la! Helllll naw.');
        return false;
      } else {
        console.log('Not attacking Faycebook, let pass.');
        HTMLFormElement.prototype.real_submit.apply(frm);
      }
    }

    window.onload = function() {
      interceptor_setup();
    };
    //document.attackFaycebook.submit();
  </script>
</body>
</html>
